name: Sistema de Cortes MÃ­dia

on:
  repository_dispatch:
    types: [novo_relatorio]

jobs:
  processamento:
    name: processamento
    runs-on: [self-hosted, Windows, X64, midia-cutter]

    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Mostrar SHA
        shell: powershell
        run: |
          echo "github.sha = ${{ github.sha }}"
          git rev-parse HEAD
          echo "workflow_sha = ${{ github.workflow_sha }}"

      - name: Verificar Python deps
        shell: powershell
        run: |
          python --version
          python -c "import psutil, GPUtil; print('deps OK')"

      - name: Executar Motor de Corte
        shell: powershell
        run: python processar_cortes.py --event-path "${{ github.event_path }}"
